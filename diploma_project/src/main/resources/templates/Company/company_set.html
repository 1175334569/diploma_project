<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>111</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/myCss.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

</head>
<style type="text/css">
    .tangram-suggestion-main {
        z-index: 999999;
    }
</style>
<body>
<nav class="navbar navbar-expand-lg fixed-top navbar-light bg-light">
    <div style="width: 130px"></div>
    <a class="navbar-brand" href="/">
        <img src="/img/2.png" width="30" height="30" class="d-inline-block align-top" alt="">
      高校兼职
    </a>
    <div style="width: 30px"></div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li id="li1" style="display:none">
                <div><i class="fas fa-user-tie"></i></div>
            </li>
            <li class="nav-item dropdown" id="li2" style="display: none">
                <a class="nav-link dropdown-toggle" href="#" id="User" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                </a>
                <div class="dropdown-menu" aria-labelledby="User">
                    <a class="dropdown-item"  href="/set_company">个人中心</a>
                    <a class="dropdown-item"  href="/user_set" >帐号设置</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#">退出</a>
                </div>
            </li>

        </ul>
    </div>
</nav>
<br/>
<br/>

<div id="bodycontent">
    <div class="ct-holder account wrap">
        <div class="setting-top">

           <ul>
        <li class="current" id="set_basic"><a href="/user_set" title="基本信息">基本信息</a></li>
        <li class=""  onclick="on()" id="set_password"><a href="#" title="修改密码">修改密码</a></li>
           </ul>
       </div>
        <div class="main clearfix">
        <div class="right">

            <div class="form" id="select_ba_pa">
                <div class="group">
                    <p class="leftsign">用户名：</p>
                    <p>
                    <p><input type="text" class="mytxt" id="set_username" th:value="${user.username}">
                </div>

                <div class="group">
                    <p class="leftsign">性别：</p>
                    <p class="psex">
                        <label >
                            <input name="sex" id="man_label" type="radio" value="男" >
                            <span>男</span>
                        </label>

                        <label>
                            <input name="sex" id="female_label" type="radio" value="女" >
                            <span>女</span>
                        </label>
                    </p>
                </div>

                <div class="group">
                    <p class="leftsign">邮箱：</p>
                    <p><input type="text" class="mytxt" id="set_email" readonly="readonly" style="background-color: #F0F0F0" th:value="${user.email}"></p>
                </div>

                <div class="group">
                    <p class="leftsign">手机：</p>
                    <p>
                    <p><input type="text" class="mytxt" id="set_phone" th:value="${user.phone}">
                </div>

                <div class="group">
                    <p class="leftsign">公司：</p>
                    <p>
                    <p><input type="text" class="mytxt" id="set_company" th:value="${user.company}">
                </div>

                <div class="group">
                    <p class="leftsign">
                        <div data-toggle="modal" data-target="#exampleModalCenter" onclick="baiduMap()">
                    地址：<i class="fas fa-map-marker-alt" style="color: red"></i><span><a href="#" id="address" th:text="${user.address}"></a></span>
                </div>
                   </p>
                </div>



               <!-- 模态框-->

                <!-- Modal -->
                <div class="modal fade bd-example-modal-lg" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLongTitle">地址</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body ">

                                <div id="r-result">请输入:<input type="text" id="suggestId" size="20" value="百度" style="width:150px" /></div>
                                <div id="searchResultPanel" style="border:1px solid #C0C0C0;width:150px;height:auto; display:none"></div>
                                <div style="width:600px;height:480px;border:1px solid gray;margin:30px auto" id="container"></div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary" onclick="save_company()">保存</button>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="group" id="sign">
                    <p class="leftsign">公司简介：</p>

                <!--    <div id="r-result">请输入:<input type="text" id="suggestId" size="20" value="百度" style="width:150px;" /></div>
                    <div id="searchResultPanel" style="border:1px solid #C0C0C0;width:150px;height:auto; display:none;"></div>
                    <div style="width:600px;height:480px;border:1px solid gray;margin:30px auto" id="container"></div>-->
                    <p> <textarea name="title" placeholder="请填写你的专业技能" id="set_introdution" th:text="${user.introdution}"></textarea> </p>
                </div>

                <div class="group">
                    <button value="提交" onclick="basic_summit()" class="btn btn-success">提交</button>
                </div>
            </div>
        </div>

            <span>
                <div class="right" style=" width:370px;height:400px">
                    <img style="width: 370px;height: 310px" src="/img/1.jpg">
                </div>
            </span>
        </div>
    </div>
</div>

<input id="get_sex" th:value="${user.sex}" style="display: none">
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=cPGwitKU1hWewR3dtn7reoP4l0VGlUHY"></script>
<script src="/jquery-3.0.0.js"></script>
<script src="/myJS.js"></script>0
<script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</body>
<script type="text/javascript">

    $(function () {
        if(getCookie("username")!=""){
            document.getElementById("li1").style.display="";
            document.getElementById("li2").style.display="";
        }
        else {
            document.getElementById("li1").style.display="none";
            document.getElementById("li2").style.display="none";
        }
        document.getElementById("User").innerText=getCookie("username");

        var sex=$("#get_sex").val();
        if(sex=='男')    $("#man_label").attr("checked",true);
        if(sex=='女')    $("#female_label").attr("checked",true);
    });

    var map = new BMap.Map("container");
    var point = new BMap.Point(114.02597366,22.54605355);
    map.centerAndZoom(point,12);
    // 创建地址解析器实例
    var myGeo = new BMap.Geocoder();
    // 将地址解析结果显示在地图上,并调整地图视野
    myGeo.getPoint("北京市海淀区上地10街", function(point){
        if (point) {
            map.centerAndZoom(point, 16);
            map.addOverlay(new BMap.Marker(point));
            map.enableScrollWheelZoom(true);
        }else{
            alert("您选择地址没有解析到结果!");
        }
    }, "中山市");

    var ac = new BMap.Autocomplete(    //建立一个自动完成的对象
        {"input" : "suggestId"
            ,"location" : map
        });

    ac.addEventListener("onhighlight", function(e) {  //鼠标放在下拉列表上的事件
        var str = "";
        var _value = e.fromitem.value;
        var value = "";
        if (e.fromitem.index > -1) {
            value = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
        }
        str = "FromItem<br />index = " + e.fromitem.index + "<br />value = " + value;

        value = "";
        if (e.toitem.index > -1) {
            _value = e.toitem.value;
            value = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
        }
        str += "<br />ToItem<br />index = " + e.toitem.index + "<br />value = " + value;
        document.getElementById("searchResultPanel").innerHTML = str;
    });

    var myValue;
    ac.addEventListener("onconfirm", function(e) {    //鼠标点击下拉列表后的事件
        var _value = e.item.value;
        myValue = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
        document.getElementById("searchResultPanel").innerHTML ="onconfirm<br />index = " + e.item.index + "<br />myValue = " + myValue;

        setPlace();
    });

    function setPlace(){
        map.clearOverlays();    //清除地图上所有覆盖物
        function myFun(){
            var pp = local.getResults().getPoi(0).point;    //获取第一个智能搜索的结果
            map.centerAndZoom(pp, 18);
            map.addOverlay(new BMap.Marker(pp));    //添加标注
        }
        var local = new BMap.LocalSearch(map, { //智能搜索
            onSearchComplete: myFun
        });
        local.search(myValue);
    }

   /* ===================================================================*/
    function save_company() {
        document.getElementById("address").innerText=$("#suggestId").val();
    }

    function baiduMap() {
        myValue=document.getElementById("address").text;
        setPlace();
    }

    function on() {
        document.getElementById("set_password").className="current";
        document.getElementById("set_basic").className="";
        document.getElementById("select_ba_pa").innerText="";
        $("#select_ba_pa").append("<div class=\"group\">\n" +
            "                        <p class=\"leftsign\">新密码：</p>\n" +
            "                        <p>\n" +
            "                            <input type=\"password\" name=\"password\" class=\"inputtext\" id=\"newpassword1\">\n" +
            "                        </p>\n" +
            "                    </div>\n" +
            "                    <div class=\"group\">\n" +
            "                        <p class=\"leftsign\">确认密码：</p>\n" +
            "                        <p>\n" +
            "                            <input type=\"password\" name=\"confirm_password\" class=\"inputtext\" id=\"renewpassword1\">\n" +
            "                        </p>\n" +
            "                    </div>\n" +
            "                    <button type=\"button\" onclick='userset_resetpassword()' class=\"btn btn-success\">确定修改密码</button>")
    }
    function basic_summit() {
        var username=$("#set_username").val();
        var sex=$("input[type=radio]:checked").val();
        var phone=$("#set_phone").val();
        var company=$("#set_company").val();
        var address=$("#address").text();
        var introdution=$("#set_introdution").val();
        var email=$("#set_email").val();
        $.ajax({
            url:"update_company",
            data:{
                username:username,
                sex:sex,
                phone:phone,
                company:company,
                address:address,
                introdution:introdution,
                email:email,
            },
            success:function (data) {
                alert("保存成功");
                location.reload();
            }
        })



    }
</script>


</html>